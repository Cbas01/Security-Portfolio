# CVE-2017-5638 â€” Remote Code Execution in Apache Struts

![Severity](https://img.shields.io/badge/Severity-Critical-red)
![CVSS](https://img.shields.io/badge/CVSS-10.0-critical)
![Category](https://img.shields.io/badge/Type-RCE-orange)

---

## ðŸ“Œ Summary

**CVE ID:** CVE-2017-5638  
**Software:** Apache Struts 2  
**Vulnerability Type:** Remote Code Execution (RCE)  
**Severity:** Critical (10.0)

CVE-2017-5638 is a remote code execution vulnerability affecting Apache Struts 2 applications that use the Jakarta Multipart parser. The flaw allows unauthenticated attackers to execute arbitrary system commands by sending a specially crafted HTTP request.

Because exploitation requires no authentication and targets web-facing services, the exposure risk is extremely high.

---

## ðŸŽ¯ Affected Products & Versions

- Apache Struts 2.3.5 â€“ 2.3.31  
- Apache Struts 2.5 â€“ 2.5.10  

**Patched Versions:**
- 2.3.32  
- 2.5.10.1 and later  

---

## ðŸ” Technical Root Cause

The vulnerability exists in the handling of malformed `Content-Type` headers during file upload processing.

When an invalid header is processed, the application generates an error. Instead of safely handling the input as plain text, the framework evaluates attacker-controlled input using the OGNL (Object-Graph Navigation Language) expression engine.

This results in:

- Improper input validation  
- Unsafe expression evaluation  
- OS-level command execution  

From a defensive perspective, this demonstrates how input validation failures in web applications can escalate into full server compromise.

---

## âš”ï¸ Exploitation Overview (Conceptual)

An attacker can:

1. Send a crafted HTTP request  
2. Manipulate the `Content-Type` header  
3. Inject a malicious OGNL expression  
4. Execute arbitrary commands on the server  

Potential outcomes include:

- Remote shell access  
- Malware deployment  
- Data exfiltration  
- Lateral movement  

---

## ðŸ“Š Impact Analysis

### Confidentiality
- Exposure of configuration files
- Access to database credentials
- Sensitive data compromise

### Integrity
- File modification
- Web shell deployment
- Application tampering

### Availability
- Application crashes
- Service disruption
- Ransomware deployment

This vulnerability can act as an initial access vector in broader attack chains.

---

## ðŸ›¡ Detection Opportunities

### Web-Level Indicators

- Suspicious `Content-Type` headers containing `${`, `#`, or OGNL expressions  
- Repeated malformed upload attempts  
- Unusual HTTP error patterns  

### Host-Level Indicators

- Web server spawning abnormal processes (e.g., `cmd.exe`, `bash`)  
- Unexpected outbound connections  
- Unauthorized file changes in web directories  

### Log Sources

- Web server access logs  
- Application logs  
- Windows Event Logs (Event ID 4688 â€“ Process Creation)  
- Endpoint detection alerts  
- Network monitoring tools  

Correlating suspicious HTTP activity with abnormal process creation is a strong indicator of exploitation.

---

## ðŸ”§ Mitigation & Remediation

- Upgrade to patched versions (2.3.32 / 2.5.10.1 or later)  
- Apply vendor security updates immediately  
- Deploy a Web Application Firewall (WAF)  
- Restrict unnecessary internet exposure  
- Enable centralized logging and monitoring  

Timely patch management significantly reduces exposure.

---

## ðŸ“š Defensive Takeaways

- Internet-facing applications require rapid patching  
- Application-layer vulnerabilities can lead to system-level compromise  
- Log visibility and process monitoring are critical for early detection  

Studying vulnerabilities like this improves practical defensive analysis skills relevant to entry-level Security Analyst roles.

---

## ðŸ”— References

- Official Apache Security Advisory  
- National Vulnerability Database (NVD)  
- Public CVE Database Entries  


---

> This report is created for educational and research purposes only.
